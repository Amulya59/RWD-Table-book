<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RWD TableBook</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="stage">
    <div class="flipbook">
      <div class="hard"><img src="1 Cover Sheet.jpg" alt="Cover" /></div>
      <div class="hard"></div>
      <div><img src="2 Cover Page.jpg" alt="Cover Page" /></div>
      <div><img src="whoRwe.png" alt="" /></div>
      <div><img src="content.png" alt="" /></div>
      <div><img src="founderL.png" alt="" /></div>
      <div><img src="founderR.png" alt="" /></div>
      <div><img src="pillar l.png" alt="" /></div>
      <div><img src="pillar r.png" alt="" /></div>
      <div><img src="TechL.png" alt="" /></div>
      <div><img src="TechR.png" alt="" /></div>
      <div><img src="res11L.png" alt="" /></div>
      <div><img src="res12R.png" alt="" /></div>
      <div><img src="res13L.png" alt="" /></div>
      <div><img src="res14R.png" alt="" /></div>
      <div><img src="res21L.png" alt="" /></div>
      <div><img src="res22R.png" alt="" /></div>
      <div><img src="res23L.png" alt="" /></div>
      <div><img src="res24R.png" alt="" /></div>
      <div><img src="res31L.png" alt="" /></div>
      <div><img src="res32R.png" alt="" /></div>
      <div><img src="res33L.png" alt="" /></div>
      <div><img src="res34R.png" alt="" /></div>
      <div><img src="awardL.png" alt="" /></div>
      <div><img src="awardR.png" alt="" /></div>
      <div><img src="2 Cover Page.jpg" alt="" /></div>
      <div class="hard"></div>
      <div class="hard"><img src="B Cover Sheet.jpg" alt="Back Cover" /></div>
    </div>

    <div id="rotate-msg">Please rotate your device ðŸ“±</div>
  </div>

  <script src="jquery.js"></script>
  <script src="turn.js"></script>
  <script>
    (function () {
      const BOOK_W = 3457;
      const BOOK_H = 1152;
      const flip = document.querySelector('.flipbook');
      const rotateMsg = document.getElementById('rotate-msg');

      function fitAndTransform() {
        const vw = window.innerWidth;
        const vh = window.innerHeight;

        // Detect orientation
        const isPortrait = vh > vw;

        if (isPortrait) {
          rotateMsg.style.display = 'flex';
          flip.style.display = 'none'; // hide book when vertical
        } else {
          rotateMsg.style.display = 'none';
          flip.style.display = 'block';

          // Compute scale for landscape view
          const scale = Math.min(vw / BOOK_W, vh / BOOK_H);
          flip.style.transform = `translate(-50%, -50%) scale(${scale})`;
        }
      }

      function initTurn() {
        if (typeof jQuery !== 'undefined' && typeof jQuery.fn.turn === 'function') {
          try { $('.flipbook').turn('destroy'); } catch (e) {}
          $('.flipbook').turn({
            width: BOOK_W,
            height: BOOK_H,
            autoCenter: true,
            elevation: 50,
            gradients: true
          });
        }
      }

      function waitImagesThenInit() {
        const imgs = Array.from(document.querySelectorAll('.flipbook img'));
        if (imgs.length === 0) { fitAndTransform(); initTurn(); return; }

        let loaded = 0;
        imgs.forEach(img => {
          if (img.complete) loaded++;
          else img.addEventListener('load', () => {
            loaded++;
            if (loaded === imgs.length) {
              fitAndTransform();
              initTurn();
            }
          });
        });

        if (loaded === imgs.length) {
          fitAndTransform();
          initTurn();
        }
      }

      window.addEventListener('load', () => {
        waitImagesThenInit();
        setTimeout(fitAndTransform, 300);
      });

      window.addEventListener('resize', fitAndTransform);
      window.addEventListener('orientationchange', () => setTimeout(fitAndTransform, 200));
    })();
  </script>
</body>
</html>
